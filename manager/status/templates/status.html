<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="robots" content="noindex, nofollow">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Current system status.">
  <meta http-equiv="refresh" content="300">
  <title>Imager Status</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
  <style type="text/css">h1 {font-size: 1.2rem; } table tr td:first-of-type { font-size: .9rem; }</style>
</head>
<body>
  <div class="container">
    <img src="https://imager.kiwix.org/static/img/logotype-horizontal.svg" style="height:7rem;" />
    <header class="">
      {% if global_status %}
      <h1 class="alert alert-success">All systems Operational!</h1>
      {% else %}
      <h1 class="alert alert-warning">Ongoing incident or issueâ€¦</h1>
      {% endif %}
    </header>
    <section>
      <table class="table table-stripped">
        <tr><th colspan="2">System</th><th class="text-right">Status</th></tr>
        <tr><th>Scheduler (API)</th>
            <td>Can Auth with API and retrieve info</td>
            <td class="text-right {{ scheduler_status|status_class }}">{{ scheduler_status|status_text }}</td></tr>
        <tr><th>Workers</th>
            <td>At least one worker is currently connected to the scheduler</td>
            <td class="text-right {{ worker_status|status_class }}">{{ worker_status|status_text }}</td></tr>
        <tr><th>Creator Load</th>
            <td>Creator workers are able to process queue within 24h</td>
            <td class="text-right {{ creatorload_status|status_class }}">{{ creatorload_status|status_text }}</td></tr>
        <tr><th>Manager (Imager UI)</th>
            <td>Can log-in to and retrieve config page on manager</td>
            <td class="text-right {{ manager_status|status_class }}">{{ manager_status|status_text }}</td></tr>
        <tr><th>Database (mongo)</th>
            <td>Can connect to and execute query on database</td>
            <td class="text-right {{ database_status|status_class }}">{{ database_status|status_text }}</td></tr>
        <tr><th>Auto-image URL</th>
            <td>Can redirect to a a standard image and access it</td>
            <td class="text-right {{ images_status|status_class }}">{{ images_status|status_text }}</td></tr>
        <tr><th>Auto-image exists</th>
            <td>All auto-images are present and reachable on Wasabi</td>
            <td class="text-right {{ images_exists|status_class }}">{{ images_exists|status_text }}</td></tr>
        <tr><th>Auto-image auto-deletion</th>
            <td>Auto-images are not about to be auto-deleted</td>
            <td class="text-right {{ images_deletion|status_class }}">{{ images_deletion|status_text }}</td></tr>
        <tr><th>Wasabi S3</th>
            <td>Can download a specific public file from Wasabi</td>
            <td class="text-right {{ wasabi_status|status_class }}">{{ wasabi_status|status_text }}</td></tr>
      </table>
    </section>
  </div>
</body>
</html>
